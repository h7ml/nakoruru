import{r as n,j as t}from"./index-BYIAYquO.js";import{d as e,t as r}from"./throttle-DXiF7ywQ.js";import{T as i}from"./Table-C8Kyjfa0.js";import"./iconUtil-CdrQcFRN.js";var o=function(){return o=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},o.apply(this,arguments)};function u(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]])}return e}function a(n,t,e,r){return new(e||(e=Promise))((function(i,o){function u(n){try{c(r.next(n))}catch(t){o(t)}}function a(n){try{c(r.throw(n))}catch(t){o(t)}}function c(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(u,a)}c((r=r.apply(n,t||[])).next())}))}function c(n,t){var e,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(u=0)),u;)try{if(e=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,r=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){u=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){u.label=a[1];break}if(6===a[0]&&u.label<i[1]){u.label=i[1],i=a;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(a);break}i[2]&&u.ops.pop(),u.trys.pop();continue}a=t.call(n,u)}catch(c){a=[6,c],r=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function l(n,t){var e="function"==typeof Symbol&&n[Symbol.iterator];if(!e)return n;var r,i,o=e.call(n),u=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)u.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(i)throw i.error}}return u}function s(n,t,e){if(e||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return n.concat(r||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;function f(t){var e=n.useRef(t);e.current=n.useMemo((function(){return t}),[t]);var r=n.useRef();return r.current||(r.current=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return e.current.apply(this,n)}),r.current}const d=(v=n.useEffect,function(t,e){var r=n.useRef(!1);v((function(){return function(){r.current=!1}}),[]),v((function(){if(r.current)return t();r.current=!0}),e)});var v,p=function(t,e){var r=e.manual,i=e.ready,o=void 0===i||i,u=e.defaultParams,a=void 0===u?[]:u,c=e.refreshDeps,f=void 0===c?[]:c,v=e.refreshDepsAction,p=n.useRef(!1);return p.current=!1,d((function(){!r&&o&&(p.current=!0,t.run.apply(t,s([],l(a),!1)))}),[o]),d((function(){p.current||r||(p.current=!0,v?v():t.refresh())}),s([],l(f),!1)),{onBefore:function(){if(!o)return{stopNow:!0}}}};p.onInit=function(n){var t=n.ready,e=void 0===t||t;return{loading:!n.manual&&e}};const h=p;function y(t,e){var r=n.useRef({deps:e,obj:void 0,initialized:!1}).current;return!1!==r.initialized&&function(n,t){if(n===t)return!0;for(var e=0;e<n.length;e++)if(!Object.is(n[e],t[e]))return!1;return!0}(r.deps,e)||(r.deps=e,r.obj=t(),r.initialized=!0),r.obj}function m(t){var e=n.useRef(t);return e.current=t,e}var g=function(t){var e=m(t);n.useEffect((function(){return function(){e.current()}}),[])},b=new Map,w=new Map,S={},P=function(n,t){return S[n]||(S[n]=[]),S[n].push(t),function(){var e=S[n].indexOf(t);S[n].splice(e,1)}};const j=function(t,e){var r=e.cacheKey,i=e.cacheTime,u=void 0===i?3e5:i,a=e.staleTime,c=void 0===a?0:a,f=e.setCache,d=e.getCache,v=n.useRef(),p=n.useRef(),h=function(n,t){f?f(t):function(n,t,e){var r=b.get(n);(null==r?void 0:r.timer)&&clearTimeout(r.timer);var i=void 0;t>-1&&(i=setTimeout((function(){b.delete(n)}),t)),b.set(n,o(o({},e),{timer:i}))}(n,u,t),function(n,t){S[n]&&S[n].forEach((function(n){return n(t)}))}(n,t.data)},m=function(n,t){return void 0===t&&(t=[]),d?d(t):function(n){return b.get(n)}(n)};return y((function(){if(r){var n=m(r);n&&Object.hasOwnProperty.call(n,"data")&&(t.state.data=n.data,t.state.params=n.params,(-1===c||(new Date).getTime()-n.time<=c)&&(t.state.loading=!1)),v.current=P(r,(function(n){t.setState({data:n})}))}}),[]),g((function(){var n;null===(n=v.current)||void 0===n||n.call(v)})),r?{onBefore:function(n){var t=m(r,n);return t&&Object.hasOwnProperty.call(t,"data")?-1===c||(new Date).getTime()-t.time<=c?{loading:!1,data:null==t?void 0:t.data,error:void 0,returnNow:!0}:{data:null==t?void 0:t.data,error:void 0}:{}},onRequest:function(n,t){var e=function(n){return w.get(n)}(r);return e&&e!==p.current||(e=n.apply(void 0,s([],l(t),!1)),p.current=e,function(n,t){w.set(n,t),t.then((function(t){return w.delete(n),t})).catch((function(){w.delete(n)}))}(r,e)),{servicePromise:e}},onSuccess:function(n,e){var i;r&&(null===(i=v.current)||void 0===i||i.call(v),h(r,{data:n,params:e,time:(new Date).getTime()}),v.current=P(r,(function(n){t.setState({data:n})})))},onMutate:function(n){var e;r&&(null===(e=v.current)||void 0===e||e.call(v),h(r,{data:n,params:t.state.params,time:(new Date).getTime()}),v.current=P(r,(function(n){t.setState({data:n})})))}}:{}};const O=function(t,r){var i=r.debounceWait,o=r.debounceLeading,u=r.debounceTrailing,a=r.debounceMaxWait,c=n.useRef(),f=n.useMemo((function(){var n={};return void 0!==o&&(n.leading=o),void 0!==u&&(n.trailing=u),void 0!==a&&(n.maxWait=a),n}),[o,u,a]);return n.useEffect((function(){if(i){var n=t.runAsync.bind(t);return c.current=e((function(n){n()}),i,f),t.runAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Promise((function(e,r){var i;null===(i=c.current)||void 0===i||i.call(c,(function(){n.apply(void 0,s([],l(t),!1)).then(e).catch(r)}))}))},function(){var e;null===(e=c.current)||void 0===e||e.cancel(),t.runAsync=n}}}),[i,f]),i?{onCancel:function(){var n;null===(n=c.current)||void 0===n||n.cancel()}}:{}};const R=function(t,e){var r=e.loadingDelay,i=e.ready,o=n.useRef();if(!r)return{};var u=function(){o.current&&clearTimeout(o.current)};return{onBefore:function(){return u(),!1!==i&&(o.current=setTimeout((function(){t.setState({loading:!0})}),r)),{loading:!1}},onFinally:function(){u()},onCancel:function(){u()}}};var x=!("undefined"==typeof window||!window.document||!window.document.createElement);function T(){return!x||"hidden"!==document.visibilityState}var E=[];if(x){window.addEventListener("visibilitychange",(function(){if(T())for(var n=0;n<E.length;n++){(0,E[n])()}}),!1)}const A=function(t,e){var r=e.pollingInterval,i=e.pollingWhenHidden,o=void 0===i||i,u=e.pollingErrorRetryCount,a=void 0===u?-1:u,c=n.useRef(),l=n.useRef(),s=n.useRef(0),f=function(){var n;c.current&&clearTimeout(c.current),null===(n=l.current)||void 0===n||n.call(l)};return d((function(){r||f()}),[r]),r?{onBefore:function(){f()},onError:function(){s.current+=1},onSuccess:function(){s.current=0},onFinally:function(){-1===a||-1!==a&&s.current<=a?c.current=setTimeout((function(){var n;o||T()?t.refresh():l.current=(n=function(){t.refresh()},E.push(n),function(){var t=E.indexOf(n);E.splice(t,1)})}),r):s.current=0},onCancel:function(){f()}}:{}};var C=[];if(x){var I=function(){if(T()&&(!x||void 0===navigator.onLine||navigator.onLine))for(var n=0;n<C.length;n++){(0,C[n])()}};window.addEventListener("visibilitychange",I,!1),window.addEventListener("focus",I,!1)}const B=function(t,e){var r=e.refreshOnWindowFocus,i=e.focusTimespan,o=void 0===i?5e3:i,u=n.useRef(),a=function(){var n;null===(n=u.current)||void 0===n||n.call(u)};return n.useEffect((function(){if(r){var n=(i=t.refresh.bind(t),c=o,f=!1,function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];f||(f=!0,i.apply(void 0,s([],l(n),!1)),setTimeout((function(){f=!1}),c))});u.current=(e=function(){n()},C.push(e),function(){var n=C.indexOf(e);n>-1&&C.splice(n,1)})}var e,i,c,f;return function(){a()}}),[r,o]),g((function(){a()})),{}};const H=function(t,e){var r=e.retryInterval,i=e.retryCount,o=n.useRef(),u=n.useRef(0),a=n.useRef(!1);return i?{onBefore:function(){a.current||(u.current=0),a.current=!1,o.current&&clearTimeout(o.current)},onSuccess:function(){u.current=0},onError:function(){if(u.current+=1,-1===i||u.current<=i){var n=null!=r?r:Math.min(1e3*Math.pow(2,u.current),3e4);o.current=setTimeout((function(){a.current=!0,t.refresh()}),n)}else u.current=0},onCancel:function(){u.current=0,o.current&&clearTimeout(o.current)}}:{}};const M=function(t,e){var i=e.throttleWait,o=e.throttleLeading,u=e.throttleTrailing,a=n.useRef(),c={};return void 0!==o&&(c.leading=o),void 0!==u&&(c.trailing=u),n.useEffect((function(){if(i){var n=t.runAsync.bind(t);return a.current=r((function(n){n()}),i,c),t.runAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Promise((function(e,r){var i;null===(i=a.current)||void 0===i||i.call(a,(function(){n.apply(void 0,s([],l(t),!1)).then(e).catch(r)}))}))},function(){var e;t.runAsync=n,null===(e=a.current)||void 0===e||e.cancel()}}}),[i,o,u]),i?{onCancel:function(){var n;null===(n=a.current)||void 0===n||n.cancel()}}:{}};var D=function(t){n.useEffect((function(){null==t||t()}),[])},N=function(){var t=l(n.useState({}),2)[1];return n.useCallback((function(){return t({})}),[])};const F=function(){function n(n,t,e,r){void 0===r&&(r={}),this.serviceRef=n,this.options=t,this.subscribe=e,this.initState=r,this.count=0,this.state={loading:!1,params:void 0,data:void 0,error:void 0},this.state=o(o(o({},this.state),{loading:!t.manual}),r)}return n.prototype.setState=function(n){void 0===n&&(n={}),this.state=o(o({},this.state),n),this.subscribe()},n.prototype.runPluginHandler=function(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var r=this.pluginImpls.map((function(e){var r;return null===(r=e[n])||void 0===r?void 0:r.call.apply(r,s([e],l(t),!1))})).filter(Boolean);return Object.assign.apply(Object,s([{}],l(r),!1))},n.prototype.runAsync=function(){for(var n,t,e,r,i,f,d,v,p,h,y=[],m=0;m<arguments.length;m++)y[m]=arguments[m];return a(this,void 0,void 0,(function(){var a,m,g,b,w,S,P,j,O,R,x;return c(this,(function(c){switch(c.label){case 0:if(this.count+=1,a=this.count,m=this.runPluginHandler("onBefore",y),g=m.stopNow,b=void 0!==g&&g,w=m.returnNow,S=void 0!==w&&w,P=u(m,["stopNow","returnNow"]),b)return[2,new Promise((function(){}))];if(this.setState(o({loading:!0,params:y},P)),S)return[2,Promise.resolve(P.data)];null===(t=(n=this.options).onBefore)||void 0===t||t.call(n,y),c.label=1;case 1:return c.trys.push([1,3,,4]),(j=this.runPluginHandler("onRequest",this.serviceRef.current,y).servicePromise)||(j=(x=this.serviceRef).current.apply(x,s([],l(y),!1))),[4,j];case 2:return O=c.sent(),a!==this.count?[2,new Promise((function(){}))]:(this.setState({data:O,error:void 0,loading:!1}),null===(r=(e=this.options).onSuccess)||void 0===r||r.call(e,O,y),this.runPluginHandler("onSuccess",O,y),null===(f=(i=this.options).onFinally)||void 0===f||f.call(i,y,O,void 0),a===this.count&&this.runPluginHandler("onFinally",y,O,void 0),[2,O]);case 3:if(R=c.sent(),a!==this.count)return[2,new Promise((function(){}))];throw this.setState({error:R,loading:!1}),null===(v=(d=this.options).onError)||void 0===v||v.call(d,R,y),this.runPluginHandler("onError",R,y),null===(h=(p=this.options).onFinally)||void 0===h||h.call(p,y,void 0,R),a===this.count&&this.runPluginHandler("onFinally",y,void 0,R),R;case 4:return[2]}}))}))},n.prototype.run=function(){for(var n=this,t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.runAsync.apply(this,s([],l(t),!1)).catch((function(t){n.options.onError}))},n.prototype.cancel=function(){this.count+=1,this.setState({loading:!1}),this.runPluginHandler("onCancel")},n.prototype.refresh=function(){this.run.apply(this,s([],l(this.state.params||[]),!1))},n.prototype.refreshAsync=function(){return this.runAsync.apply(this,s([],l(this.state.params||[]),!1))},n.prototype.mutate=function(n){var t="function"==typeof n?n(this.state.data):n;this.runPluginHandler("onMutate",t),this.setState({data:t})},n}();function L(n,t,e){return function(n,t,e){void 0===t&&(t={}),void 0===e&&(e=[]);var r=t.manual,i=void 0!==r&&r,a=u(t,["manual"]),c=o({manual:i},a),d=m(n),v=N(),p=y((function(){var n=e.map((function(n){var t;return null===(t=null==n?void 0:n.onInit)||void 0===t?void 0:t.call(n,c)})).filter(Boolean);return new F(d,c,v,Object.assign.apply(Object,s([{}],l(n),!1)))}),[]);return p.options=c,p.pluginImpls=e.map((function(n){return n(p,c)})),D((function(){if(!i){var n=p.state.params||t.defaultParams||[];p.run.apply(p,s([],l(n),!1))}})),g((function(){p.cancel()})),{loading:p.state.loading,data:p.state.data,error:p.state.error,params:p.state.params||[],cancel:f(p.cancel.bind(p)),refresh:f(p.refresh.bind(p)),refreshAsync:f(p.refreshAsync.bind(p)),run:f(p.run.bind(p)),runAsync:f(p.runAsync.bind(p)),mutate:f(p.mutate.bind(p))}}(n,t,s(s([],l(e||[]),!1),[O,R,A,B,M,h,j,H],!1))}function W(){return fetch("/api/system/user?page=1&limit=50").then((n=>n.json()))}const k=()=>{const{data:n,error:e,loading:r}=L(W);if(e)return t.jsx("div",{children:"failed to load"});if(r)return t.jsx("div",{children:"loading..."});if(!n)return null;const o={list:n.response.data,total:n.response.data.length};return t.jsx(i,{columns:[{title:"name",dataIndex:["id"]},{title:"lastName",dataIndex:"lastName"},{title:"email",dataIndex:"email"},{title:"department",dataIndex:"department"}],rowKey:"email",dataSource:o.list})};export{k as TableInfo,k as default};
